{% extends 'app/base.html' %}

{% block content %}
<h1>Pet List</h1>

{% if request.user.is_staff %}
    <a href="{% url 'pet_create' %}" class="btn btn-primary mb-3">Add New Pet</a>
{% endif %}

<ul class="list-group">
    {% for pet in pets %}
    <li class="list-group-item">
        <h3><a href="{{ pet.get_absolute_url }}">{{ pet.name }}</a></h3>
        <p><strong>Animal:</strong> {{ pet.animal }}</p>
        <p><strong>Breed:</strong> {{ pet.breed }}</p>
        <p><strong>Age:</strong> {{ pet.age }} years</p>

        {% if pet.post_image %}
            <img src="{{ pet.post_image.url }}" alt="{{ pet.name }}" class="img-thumbnail" style="max-width: 200px;">
        {% endif %}

        <!-- Application form for each pet -->
        {% if not request.user.is_staff %}
        <form action="{% url 'adoption_application_create' %}" method="post" class="mt-3">
            {% csrf_token %}
            <input type="hidden" name="pet" value="{{ pet.pk }}">

            <div class="form-group">
                <label for="id_reason_for_adoption_{{ pet.pk }}">Reason for Adoption</label>
                <textarea id="id_reason_for_adoption_{{ pet.pk }}" name="reason_for_adoption" class="form-control" rows="3" required></textarea>
            </div>

            <div class="form-group">
                <label for="id_additional_details_{{ pet.pk }}">Additional Details</label>
                <textarea id="id_additional_details_{{ pet.pk }}" name="additional_details" class="form-control" rows="3"></textarea>
            </div>

            <button type="submit" class="btn btn-success btn-sm">Apply for Adoption</button>
        </form>
        {% endif %}
    </li>
    {% empty %}
    <p>No pets available.</p>
    {% endfor %}
</ul>
{% endblock content %}
